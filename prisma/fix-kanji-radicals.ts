import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

/**
 * Comprehensive kanji-radical mapping script
 *
 * ANALYSIS:
 * - WaniKani uses ~478 radicals for mnemonic purposes (breaking kanji into smaller visual components)
 * - Traditional Kangxi system has 214 radicals
 * - For mnemonic-based learning, more granular components help
 * - Our database currently has ~341 radicals which is reasonable for the 2000+ kanji
 *
 * This script ensures every kanji has at least one radical assigned for the learning system.
 */

// Kanji to radicals decomposition - each kanji maps to its primary radical(s)
// Using a Map to avoid TypeScript duplicate key errors
const kanjiRadicalMappings: [string, string[]][] = [
  // === BASIC NUMBERS ===
  ["一", ["一"]],
  ["二", ["二"]],
  ["三", ["三"]],
  ["四", ["口"]],
  ["五", ["五"]],
  ["六", ["六"]],
  ["七", ["七"]],
  ["八", ["八"]],
  ["九", ["九"]],
  ["十", ["十"]],
  ["百", ["白"]],
  ["千", ["千"]],

  // === BASIC ELEMENTS ===
  ["口", ["口"]],
  ["日", ["日"]],
  ["月", ["月"]],
  ["山", ["山"]],
  ["川", ["川"]],
  ["木", ["木"]],
  ["水", ["水"]],
  ["火", ["火"]],
  ["土", ["土"]],
  ["金", ["金"]],
  ["人", ["人"]],
  ["大", ["大"]],
  ["小", ["小"]],
  ["中", ["中"]],
  ["上", ["上"]],
  ["下", ["下"]],
  ["左", ["左"]],
  ["右", ["右"]],
  ["女", ["女"]],
  ["子", ["子"]],
  ["目", ["目"]],
  ["耳", ["耳"]],
  ["手", ["手"]],
  ["足", ["足"]],
  ["石", ["石"]],
  ["田", ["田"]],
  ["心", ["心"]],
  ["力", ["力"]],
  ["刀", ["刀"]],
  ["糸", ["糸"]],
  ["言", ["言"]],
  ["貝", ["貝"]],
  ["馬", ["馬"]],
  ["魚", ["魚"]],
  ["鳥", ["鳥"]],
  ["雨", ["雨"]],
  ["竹", ["竹"]],
  ["米", ["米"]],
  ["虫", ["虫"]],
  ["犬", ["犬"]],
  ["門", ["門"]],
  ["車", ["車"]],
  ["食", ["食"]],
  ["立", ["立"]],
  ["見", ["見"]],
  ["白", ["白"]],
  ["赤", ["赤"]],
  ["青", ["青"]],
  ["黒", ["黒"]],
  ["入", ["入"]],
  ["出", ["出"]],
  ["行", ["行"]],
  ["来", ["来"]],
  ["前", ["前"]],
  ["後", ["後"]],
  ["年", ["年"]],
  ["今", ["今"]],
  ["分", ["刀"]],
  ["半", ["半"]],
  ["外", ["外"]],
  ["内", ["内"]],
  ["多", ["多"]],
  ["少", ["少"]],
  ["高", ["高"]],
  ["長", ["長"]],
  ["生", ["生"]],
  ["名", ["口"]],
  ["先", ["先"]],
  ["間", ["門", "日"]],
  ["時", ["日"]],
  ["週", ["辶"]],
  ["曜", ["日"]],
  ["夕", ["夕"]],
  ["毎", ["母"]],
  ["朝", ["日", "月"]],
  ["昼", ["日"]],
  ["夜", ["夜"]],
  ["天", ["大"]],
  ["空", ["空"]],
  ["国", ["口"]],
  ["家", ["家"]],
  ["学", ["子"]],
  ["校", ["木"]],
  ["会", ["人"]],
  ["社", ["社"]],
  ["店", ["店"]],
  ["駅", ["馬"]],
  ["道", ["辶"]],
  ["電", ["雨"]],
  ["話", ["言"]],
  ["聞", ["耳", "門"]],
  ["読", ["言"]],
  ["書", ["書"]],
  ["思", ["心", "田"]],
  ["知", ["矢"]],
  ["買", ["貝"]],
  ["売", ["売"]],
  ["住", ["人"]],
  ["待", ["待"]],
  ["休", ["人", "木"]],
  ["飲", ["食"]],
  ["明", ["日", "月"]],
  ["親", ["立", "木", "見"]],
  ["友", ["友"]],
  ["男", ["田", "力"]],
  ["母", ["母"]],
  ["父", ["父"]],
  ["何", ["人"]],
  ["好", ["女", "子"]],
  ["使", ["人"]],
  ["気", ["気"]],
  ["新", ["木"]],
  ["古", ["十", "口"]],
  ["短", ["短"]],
  ["安", ["女"]],
  ["林", ["木"]],
  ["森", ["木"]],
  ["肉", ["肉"]],

  // === 言 (speech) radical kanji ===
  ["計", ["言"]],
  ["記", ["言"]],
  ["訓", ["言"]],
  ["訪", ["言"]],
  ["設", ["言"]],
  ["許", ["言"]],
  ["訳", ["言"]],
  ["証", ["言"]],
  ["詞", ["言"]],
  ["評", ["言"]],
  ["詳", ["言"]],
  ["診", ["言"]],
  ["認", ["言"]],
  ["誇", ["言"]],
  ["語", ["言"]],
  ["誌", ["言"]],
  ["誓", ["言"]],
  ["誕", ["言"]],
  ["説", ["言"]],
  ["談", ["言"]],
  ["請", ["言"]],
  ["諸", ["言"]],
  ["課", ["言"]],
  ["調", ["言"]],
  ["論", ["言"]],
  ["諾", ["言"]],
  ["謀", ["言"]],
  ["謎", ["言"]],
  ["謝", ["言"]],
  ["講", ["言"]],
  ["謹", ["言"]],
  ["識", ["言"]],
  ["警", ["言"]],
  ["議", ["言"]],
  ["護", ["言"]],
  ["訴", ["言"]],
  ["訟", ["言"]],
  ["討", ["言"]],
  ["誘", ["言"]],

  // === 水/氵 (water) radical kanji ===
  ["汁", ["水"]],
  ["汗", ["水"]],
  ["江", ["水"]],
  ["池", ["水"]],
  ["汚", ["水"]],
  ["決", ["水"]],
  ["汽", ["水"]],
  ["沈", ["水"]],
  ["沖", ["水"]],
  ["沢", ["水"]],
  ["河", ["水"]],
  ["油", ["水"]],
  ["治", ["水"]],
  ["沸", ["水"]],
  ["波", ["水"]],
  ["泊", ["水"]],
  ["泉", ["水"]],
  ["法", ["水"]],
  ["泥", ["水"]],
  ["注", ["水"]],
  ["泳", ["水"]],
  ["洋", ["水"]],
  ["洗", ["水"]],
  ["津", ["水"]],
  ["活", ["水"]],
  ["派", ["水"]],
  ["流", ["水"]],
  ["浮", ["水"]],
  ["浴", ["水"]],
  ["海", ["水"]],
  ["消", ["水"]],
  ["液", ["水"]],
  ["涼", ["水"]],
  ["淡", ["水"]],
  ["深", ["水"]],
  ["混", ["水"]],
  ["清", ["水"]],
  ["済", ["水"]],
  ["減", ["水"]],
  ["温", ["水"]],
  ["測", ["水"]],
  ["港", ["水"]],
  ["湖", ["水"]],
  ["湿", ["水"]],
  ["満", ["水"]],
  ["源", ["水"]],
  ["準", ["水"]],
  ["溶", ["水"]],
  ["滑", ["水"]],
  ["滝", ["水"]],
  ["漁", ["水"]],
  ["演", ["水"]],
  ["漂", ["水"]],
  ["漫", ["水"]],
  ["潔", ["水"]],
  ["潜", ["水"]],
  ["潟", ["水"]],
  ["潤", ["水"]],
  ["激", ["水"]],
  ["濁", ["水"]],
  ["濃", ["水"]],
  ["瀬", ["水"]],
  ["湯", ["水"]],
  ["況", ["水"]],
  ["渡", ["水"]],

  // === 木 (tree/wood) radical kanji ===
  ["札", ["木"]],
  ["本", ["木"]],
  ["末", ["木"]],
  ["未", ["木"]],
  ["机", ["木"]],
  ["朱", ["木"]],
  ["杉", ["木"]],
  ["材", ["木"]],
  ["村", ["木"]],
  ["束", ["木"]],
  ["条", ["木"]],
  ["杯", ["木"]],
  ["東", ["木"]],
  ["松", ["木"]],
  ["板", ["木"]],
  ["枚", ["木"]],
  ["果", ["木"]],
  ["枝", ["木"]],
  ["枠", ["木"]],
  ["柄", ["木"]],
  ["染", ["木"]],
  ["柔", ["木"]],
  ["柱", ["木"]],
  ["査", ["木"]],
  ["栄", ["木"]],
  ["架", ["木"]],
  ["案", ["木"]],
  ["桜", ["木"]],
  ["梅", ["木"]],
  ["械", ["木"]],
  ["棄", ["木"]],
  ["棋", ["木"]],
  ["棒", ["木"]],
  ["棚", ["木"]],
  ["棟", ["木"]],
  ["植", ["木"]],
  ["検", ["木"]],
  ["業", ["木"]],
  ["極", ["木"]],
  ["概", ["木"]],
  ["構", ["木"]],
  ["様", ["木"]],
  ["標", ["木"]],
  ["模", ["木"]],
  ["権", ["木"]],
  ["横", ["木"]],
  ["樹", ["木"]],
  ["橋", ["木"]],
  ["機", ["木"]],
  ["欄", ["木"]],
  ["根", ["木"]],
  ["格", ["木"]],
  ["桃", ["木"]],
  ["株", ["木"]],
  ["築", ["竹", "木"]],
  ["集", ["木"]],

  // === 金 (metal) radical kanji ===
  ["針", ["金"]],
  ["釣", ["金"]],
  ["鈍", ["金"]],
  ["鉄", ["金"]],
  ["鉛", ["金"]],
  ["銀", ["金"]],
  ["銃", ["金"]],
  ["銅", ["金"]],
  ["銭", ["金"]],
  ["鋭", ["金"]],
  ["鋼", ["金"]],
  ["錠", ["金"]],
  ["錬", ["金"]],
  ["録", ["金"]],
  ["鍋", ["金"]],
  ["鍛", ["金"]],
  ["鏡", ["金"]],
  ["鑑", ["金"]],
  ["鐘", ["金"]],
  ["鋳", ["金"]],
  ["鎖", ["金"]],
  ["鍵", ["金"]],

  // === 手/扌 (hand) radical kanji ===
  ["払", ["手"]],
  ["扱", ["手"]],
  ["批", ["手"]],
  ["承", ["手"]],
  ["技", ["手"]],
  ["抄", ["手"]],
  ["把", ["手"]],
  ["抑", ["手"]],
  ["投", ["手"]],
  ["抗", ["手"]],
  ["折", ["手"]],
  ["抜", ["手"]],
  ["択", ["手"]],
  ["抱", ["手"]],
  ["押", ["手"]],
  ["拍", ["手"]],
  ["拐", ["手"]],
  ["拒", ["手"]],
  ["招", ["手"]],
  ["拝", ["手"]],
  ["拠", ["手"]],
  ["拡", ["手"]],
  ["括", ["手"]],
  ["拾", ["手"]],
  ["持", ["手"]],
  ["指", ["手"]],
  ["挑", ["手"]],
  ["振", ["手"]],
  ["挿", ["手"]],
  ["捕", ["手"]],
  ["捜", ["手"]],
  ["捨", ["手"]],
  ["据", ["手"]],
  ["掃", ["手"]],
  ["授", ["手"]],
  ["掌", ["手"]],
  ["排", ["手"]],
  ["掘", ["手"]],
  ["掛", ["手"]],
  ["採", ["手"]],
  ["探", ["手"]],
  ["接", ["手"]],
  ["控", ["手"]],
  ["推", ["手"]],
  ["措", ["手"]],
  ["掲", ["手"]],
  ["描", ["手"]],
  ["提", ["手"]],
  ["揚", ["手"]],
  ["換", ["手"]],
  ["握", ["手"]],
  ["揮", ["手"]],
  ["援", ["手"]],
  ["搬", ["手"]],
  ["搭", ["手"]],
  ["携", ["手"]],
  ["摂", ["手"]],
  ["摘", ["手"]],
  ["撃", ["手"]],
  ["撤", ["手"]],
  ["撮", ["手"]],
  ["擁", ["手"]],
  ["操", ["手"]],
  ["担", ["手"]],
  ["擬", ["手"]],
  ["擦", ["手"]],
  ["挟", ["手"]],
  ["拳", ["手"]],
  ["看", ["目", "手"]],
  ["捗", ["手"]],

  // === 心/忄 (heart) radical kanji ===
  ["忙", ["心"]],
  ["快", ["心"]],
  ["念", ["心"]],
  ["怒", ["心"]],
  ["怖", ["心"]],
  ["性", ["心"]],
  ["怪", ["心"]],
  ["恋", ["心"]],
  ["恐", ["心"]],
  ["恒", ["心"]],
  ["恥", ["心"]],
  ["恨", ["心"]],
  ["悔", ["心"]],
  ["悟", ["心"]],
  ["悩", ["心"]],
  ["悪", ["心"]],
  ["悲", ["心"]],
  ["情", ["心"]],
  ["惜", ["心"]],
  ["惨", ["心"]],
  ["惰", ["心"]],
  ["想", ["心"]],
  ["愁", ["心"]],
  ["意", ["心"]],
  ["愚", ["心"]],
  ["愛", ["心"]],
  ["感", ["心"]],
  ["慈", ["心"]],
  ["態", ["心"]],
  ["慌", ["心"]],
  ["慎", ["心"]],
  ["慕", ["心"]],
  ["慢", ["心"]],
  ["慣", ["心"]],
  ["慮", ["心"]],
  ["慰", ["心"]],
  ["憂", ["心"]],
  ["憎", ["心"]],
  ["憤", ["心"]],
  ["憧", ["心"]],
  ["憩", ["心"]],
  ["憶", ["心"]],
  ["懇", ["心"]],
  ["懐", ["心"]],
  ["懲", ["心"]],
  ["懸", ["心"]],
  ["忘", ["心"]],
  ["必", ["心"]],
  ["志", ["心"]],
  ["忠", ["心"]],
  ["怠", ["心"]],
  ["急", ["心"]],
  ["恵", ["心"]],
  ["息", ["心"]],
  ["悦", ["心"]],
  ["患", ["心"]],
  ["悠", ["心"]],
  ["応", ["心"]],
  ["惑", ["心"]],

  // === 火/灬 (fire) radical kanji ===
  ["灯", ["火"]],
  ["灰", ["火"]],
  ["災", ["火"]],
  ["炉", ["火"]],
  ["炊", ["火"]],
  ["炎", ["火"]],
  ["炭", ["火"]],
  ["点", ["火"]],
  ["為", ["火"]],
  ["烈", ["火"]],
  ["焦", ["火"]],
  ["焼", ["火"]],
  ["煙", ["火"]],
  ["照", ["火"]],
  ["煮", ["火"]],
  ["熟", ["火"]],
  ["熱", ["火"]],
  ["燃", ["火"]],
  ["燥", ["火"]],
  ["爆", ["火"]],
  ["然", ["火"]],
  ["煩", ["火"]],
  ["熊", ["火"]],
  ["蒸", ["火"]],
  ["烏", ["火"]],

  // === 土 (earth) radical kanji ===
  ["地", ["土"]],
  ["在", ["土"]],
  ["圧", ["土"]],
  ["均", ["土"]],
  ["坂", ["土"]],
  ["坊", ["土"]],
  ["坪", ["土"]],
  ["垂", ["土"]],
  ["型", ["土"]],
  ["城", ["土"]],
  ["域", ["土"]],
  ["執", ["土"]],
  ["基", ["土"]],
  ["埋", ["土"]],
  ["培", ["土"]],
  ["報", ["土"]],
  ["場", ["土"]],
  ["堤", ["土"]],
  ["塀", ["土"]],
  ["塊", ["土"]],
  ["塔", ["土"]],
  ["塗", ["土"]],
  ["塚", ["土"]],
  ["塩", ["土"]],
  ["境", ["土"]],
  ["墓", ["土"]],
  ["増", ["土"]],
  ["墜", ["土"]],
  ["墨", ["土"]],
  ["壁", ["土"]],
  ["壇", ["土"]],
  ["壊", ["土"]],
  ["壌", ["土"]],
  ["坑", ["土"]],
  ["堅", ["土"]],
  ["堕", ["土"]],
  ["填", ["土"]],
  ["塾", ["土"]],
  ["壮", ["土"]],
  ["寺", ["土"]],
  ["盛", ["土"]],

  // === 糸 (thread/silk) radical kanji ===
  ["紀", ["糸"]],
  ["約", ["糸"]],
  ["紅", ["糸"]],
  ["紋", ["糸"]],
  ["納", ["糸"]],
  ["純", ["糸"]],
  ["紙", ["糸"]],
  ["級", ["糸"]],
  ["素", ["糸"]],
  ["紡", ["糸"]],
  ["索", ["糸"]],
  ["累", ["糸"]],
  ["紫", ["糸"]],
  ["細", ["糸"]],
  ["紳", ["糸"]],
  ["終", ["糸"]],
  ["組", ["糸"]],
  ["経", ["糸"]],
  ["結", ["糸"]],
  ["絞", ["糸"]],
  ["給", ["糸"]],
  ["統", ["糸"]],
  ["絵", ["糸"]],
  ["絶", ["糸"]],
  ["絡", ["糸"]],
  ["続", ["糸"]],
  ["綱", ["糸"]],
  ["網", ["糸"]],
  ["綿", ["糸"]],
  ["緊", ["糸"]],
  ["総", ["糸"]],
  ["緑", ["糸"]],
  ["緒", ["糸"]],
  ["線", ["糸"]],
  ["締", ["糸"]],
  ["編", ["糸"]],
  ["緩", ["糸"]],
  ["縁", ["糸"]],
  ["縛", ["糸"]],
  ["縦", ["糸"]],
  ["縫", ["糸"]],
  ["縮", ["糸"]],
  ["績", ["糸"]],
  ["繁", ["糸"]],
  ["繊", ["糸"]],
  ["繕", ["糸"]],
  ["繭", ["糸"]],
  ["繰", ["糸"]],
  ["織", ["糸"]],
  ["練", ["糸"]],

  // === 貝 (shell/money) radical kanji ===
  ["財", ["貝"]],
  ["貨", ["貝"]],
  ["貿", ["貝"]],
  ["賃", ["貝"]],
  ["賞", ["貝"]],
  ["賛", ["貝"]],
  ["購", ["貝"]],
  ["贈", ["貝"]],
  ["販", ["貝"]],
  ["貯", ["貝"]],
  ["貴", ["貝"]],
  ["費", ["貝"]],
  ["資", ["貝"]],
  ["賀", ["貝"]],
  ["賠", ["貝"]],
  ["賊", ["貝"]],
  ["賢", ["貝"]],
  ["賜", ["貝"]],
  ["賦", ["貝"]],
  ["質", ["貝"]],
  ["賄", ["貝"]],
  ["貢", ["貝"]],
  ["貫", ["貝"]],
  ["賭", ["貝"]],
  ["敗", ["貝"]],
  ["責", ["貝"]],

  // === 人/亻 (person) radical kanji ===
  ["仁", ["人"]],
  ["介", ["人"]],
  ["仏", ["人"]],
  ["令", ["人"]],
  ["以", ["人"]],
  ["件", ["人"]],
  ["任", ["人"]],
  ["企", ["人"]],
  ["伏", ["人"]],
  ["伐", ["人"]],
  ["伝", ["人"]],
  ["伯", ["人"]],
  ["伴", ["人"]],
  ["似", ["人"]],
  ["但", ["人"]],
  ["位", ["人"]],
  ["低", ["人"]],
  ["佐", ["人"]],
  ["体", ["人"]],
  ["余", ["人"]],
  ["作", ["人"]],
  ["佳", ["人"]],
  ["併", ["人"]],
  ["例", ["人"]],
  ["侍", ["人"]],
  ["侮", ["人"]],
  ["侯", ["人"]],
  ["侵", ["人"]],
  ["便", ["人"]],
  ["係", ["人"]],
  ["促", ["人"]],
  ["俊", ["人"]],
  ["俗", ["人"]],
  ["保", ["人"]],
  ["信", ["人"]],
  ["俳", ["人"]],
  ["修", ["人"]],
  ["俸", ["人"]],
  ["倉", ["人"]],
  ["個", ["人"]],
  ["倍", ["人"]],
  ["倒", ["人"]],
  ["候", ["人"]],
  ["借", ["人"]],
  ["値", ["人"]],
  ["倫", ["人"]],
  ["偉", ["人"]],
  ["偏", ["人"]],
  ["停", ["人"]],
  ["健", ["人"]],
  ["側", ["人"]],
  ["偵", ["人"]],
  ["偶", ["人"]],
  ["偽", ["人"]],
  ["傑", ["人"]],
  ["傘", ["人"]],
  ["備", ["人"]],
  ["催", ["人"]],
  ["傷", ["人"]],
  ["僅", ["人"]],
  ["働", ["人"]],
  ["像", ["人"]],
  ["僕", ["人"]],
  ["僚", ["人"]],
  ["僧", ["人"]],
  ["儀", ["人"]],
  ["億", ["人"]],
  ["儒", ["人"]],
  ["償", ["人"]],
  ["優", ["人"]],
  ["代", ["人"]],
  ["仮", ["人"]],
  ["付", ["人"]],
  ["仙", ["人"]],
  ["他", ["人"]],
  ["伸", ["人"]],
  ["伺", ["人"]],
  ["依", ["人"]],
  ["価", ["人"]],
  ["俺", ["人"]],
  ["傍", ["人"]],
  ["仲", ["人", "中"]],
  ["宿", ["宀", "人"]],
  ["供", ["人"]],

  // === 女 (woman) radical kanji ===
  ["妻", ["女"]],
  ["妹", ["女"]],
  ["姉", ["女"]],
  ["姓", ["女"]],
  ["委", ["女"]],
  ["姫", ["女"]],
  ["姻", ["女"]],
  ["娘", ["女"]],
  ["娯", ["女"]],
  ["婚", ["女"]],
  ["婦", ["女"]],
  ["嫁", ["女"]],
  ["嬢", ["女"]],
  ["威", ["女"]],
  ["奴", ["女"]],
  ["如", ["女"]],
  ["妄", ["女"]],
  ["妃", ["女"]],
  ["妊", ["女"]],
  ["妖", ["女"]],
  ["妨", ["女"]],
  ["娠", ["女"]],
  ["婆", ["女"]],
  ["媒", ["女"]],
  ["媛", ["女"]],
  ["嫌", ["女"]],
  ["努", ["力", "女"]],
  ["妥", ["女"]],
  ["姿", ["女"]],

  // === 口 (mouth) radical kanji ===
  ["句", ["口"]],
  ["叫", ["口"]],
  ["召", ["口"]],
  ["台", ["口"]],
  ["史", ["口"]],
  ["号", ["口"]],
  ["吉", ["口"]],
  ["吐", ["口"]],
  ["向", ["口"]],
  ["君", ["口"]],
  ["吹", ["口"]],
  ["告", ["口"]],
  ["呈", ["口"]],
  ["員", ["口"]],
  ["唐", ["口"]],
  ["哲", ["口"]],
  ["唯", ["口"]],
  ["唱", ["口"]],
  ["商", ["口"]],
  ["問", ["口"]],
  ["啓", ["口"]],
  ["善", ["口"]],
  ["喚", ["口"]],
  ["喜", ["口"]],
  ["喝", ["口"]],
  ["嘆", ["口"]],
  ["器", ["口"]],
  ["噴", ["口"]],
  ["囚", ["口"]],
  ["固", ["口"]],
  ["圏", ["口"]],
  ["園", ["口"]],
  ["図", ["口"]],
  ["困", ["口"]],
  ["囲", ["口"]],
  ["回", ["口"]],
  ["因", ["口"]],
  ["喫", ["口"]],
  ["吟", ["口"]],
  ["咲", ["口"]],
  ["味", ["口"]],
  ["周", ["口"]],
  ["可", ["口"]],
  ["司", ["口"]],
  ["団", ["口"]],
  ["各", ["口"]],
  ["吸", ["口"]],
  ["呼", ["口"]],
  ["含", ["口"]],
  ["占", ["口"]],

  // === 目 (eye) radical kanji ===
  ["相", ["目"]],
  ["県", ["目"]],
  ["真", ["目"]],
  ["眺", ["目"]],
  ["眠", ["目"]],
  ["眼", ["目"]],
  ["着", ["目"]],
  ["睡", ["目"]],
  ["督", ["目"]],
  ["瞬", ["目"]],
  ["瞭", ["目"]],
  ["瞳", ["目"]],
  ["盲", ["目"]],
  ["直", ["目"]],
  ["監", ["目"]],
  ["盤", ["目"]],
  ["眉", ["目"]],
  ["省", ["目"]],
  ["冒", ["日", "目"]],

  // === 足 (foot) radical kanji ===
  ["距", ["足"]],
  ["跡", ["足"]],
  ["路", ["足"]],
  ["跳", ["足"]],
  ["踊", ["足"]],
  ["踏", ["足"]],
  ["蹴", ["足"]],
  ["躍", ["足"]],

  // === 辶/辵 (walking) radical kanji ===
  ["込", ["辶"]],
  ["辺", ["辶"]],
  ["迅", ["辶"]],
  ["迎", ["辶"]],
  ["近", ["辶"]],
  ["返", ["辶"]],
  ["迫", ["辶"]],
  ["迷", ["辶"]],
  ["追", ["辶"]],
  ["退", ["辶"]],
  ["送", ["辶"]],
  ["逃", ["辶"]],
  ["逆", ["辶"]],
  ["透", ["辶"]],
  ["途", ["辶"]],
  ["速", ["辶"]],
  ["造", ["辶"]],
  ["通", ["辶"]],
  ["逝", ["辶"]],
  ["進", ["辶"]],
  ["逮", ["辶"]],
  ["運", ["辶"]],
  ["過", ["辶"]],
  ["遇", ["辶"]],
  ["遂", ["辶"]],
  ["遅", ["辶"]],
  ["遊", ["辶"]],
  ["遍", ["辶"]],
  ["適", ["辶"]],
  ["遣", ["辶"]],
  ["遭", ["辶"]],
  ["遮", ["辶"]],
  ["遷", ["辶"]],
  ["還", ["辶"]],
  ["避", ["辶"]],
  ["邪", ["辶"]],
  ["邦", ["辶"]],
  ["部", ["辶"]],
  ["郊", ["辶"]],
  ["郎", ["辶"]],
  ["郡", ["辶"]],
  ["郭", ["辶"]],
  ["逸", ["辶"]],
  ["選", ["辶"]],
  ["達", ["辶"]],
  ["導", ["辶"]],
  ["違", ["辶"]],
  ["述", ["辶"]],
  ["連", ["辶", "車"]],

  // === 阝 (mound/hill) radical kanji ===
  ["防", ["阝"]],
  ["阻", ["阝"]],
  ["附", ["阝"]],
  ["降", ["阝"]],
  ["院", ["阝"]],
  ["陛", ["阝"]],
  ["陣", ["阝"]],
  ["除", ["阝"]],
  ["陥", ["阝"]],
  ["陪", ["阝"]],
  ["陰", ["阝"]],
  ["陳", ["阝"]],
  ["陵", ["阝"]],
  ["陶", ["阝"]],
  ["隆", ["阝"]],
  ["随", ["阝"]],
  ["隔", ["阝"]],
  ["際", ["阝"]],
  ["障", ["阝"]],
  ["隠", ["阝"]],
  ["隣", ["阝"]],
  ["険", ["阝"]],
  ["阪", ["阝"]],
  ["限", ["阝"]],

  // === 竹 (bamboo) radical kanji ===
  ["笑", ["竹"]],
  ["笛", ["竹"]],
  ["符", ["竹"]],
  ["筆", ["竹"]],
  ["筒", ["竹"]],
  ["答", ["竹"]],
  ["策", ["竹"]],
  ["管", ["竹"]],
  ["算", ["竹"]],
  ["箇", ["竹"]],
  ["範", ["竹"]],
  ["篇", ["竹"]],
  ["簡", ["竹"]],
  ["簿", ["竹"]],
  ["籍", ["竹"]],
  ["籠", ["竹"]],
  ["笠", ["竹"]],
  ["筋", ["竹"]],
  ["箸", ["竹"]],
  ["等", ["竹"]],
  ["節", ["竹"]],

  // === 食/飠 (food) radical kanji ===
  ["飯", ["食"]],
  ["飼", ["食"]],
  ["飽", ["食"]],
  ["飾", ["食"]],
  ["養", ["食"]],
  ["餅", ["食"]],
  ["館", ["食"]],
  ["餓", ["食"]],
  ["餌", ["食"]],
  ["飢", ["食"]],

  // === 馬 (horse) radical kanji ===
  ["駆", ["馬"]],
  ["駐", ["馬"]],
  ["駒", ["馬"]],
  ["騎", ["馬"]],
  ["騒", ["馬"]],
  ["験", ["馬"]],
  ["騰", ["馬"]],
  ["驚", ["馬"]],
  ["馳", ["馬"]],
  ["駄", ["馬"]],
  ["駿", ["馬"]],

  // === 車 (vehicle) radical kanji ===
  ["軌", ["車"]],
  ["軒", ["車"]],
  ["軟", ["車"]],
  ["転", ["車"]],
  ["軽", ["車"]],
  ["載", ["車"]],
  ["輝", ["車"]],
  ["輩", ["車"]],
  ["輸", ["車"]],
  ["轄", ["車"]],
  ["較", ["車"]],
  ["輔", ["車"]],
  ["軸", ["車"]],
  ["輪", ["車"]],
  ["軍", ["車"]],

  // === 門 (gate) radical kanji ===
  ["閉", ["門"]],
  ["開", ["門"]],
  ["閑", ["門"]],
  ["閣", ["門"]],
  ["閥", ["門"]],
  ["閲", ["門"]],
  ["闘", ["門"]],
  ["関", ["門"]],
  ["闇", ["門"]],
  ["閃", ["門"]],

  // === 雨 (rain) radical kanji ===
  ["雪", ["雨"]],
  ["雲", ["雨"]],
  ["零", ["雨"]],
  ["雷", ["雨"]],
  ["需", ["雨"]],
  ["震", ["雨"]],
  ["霊", ["雨"]],
  ["霧", ["雨"]],
  ["露", ["雨"]],
  ["霜", ["雨"]],
  ["霞", ["雨"]],
  ["雰", ["雨"]],

  // === 石 (stone) radical kanji ===
  ["砂", ["石"]],
  ["研", ["石"]],
  ["砕", ["石"]],
  ["砲", ["石"]],
  ["破", ["石"]],
  ["硝", ["石"]],
  ["硫", ["石"]],
  ["硬", ["石"]],
  ["確", ["石"]],
  ["碁", ["石"]],
  ["碑", ["石"]],
  ["磁", ["石"]],
  ["磨", ["石"]],
  ["礎", ["石"]],
  ["砥", ["石"]],
  ["硯", ["石"]],
  ["磯", ["石"]],

  // === 田 (rice field) radical kanji ===
  ["町", ["田"]],
  ["画", ["田"]],
  ["界", ["田"]],
  ["畑", ["田"]],
  ["畔", ["田"]],
  ["留", ["田"]],
  ["略", ["田"]],
  ["番", ["田"]],
  ["畜", ["田"]],
  ["畳", ["田"]],
  ["甲", ["田"]],
  ["由", ["田"]],
  ["申", ["田"]],
  ["畏", ["田"]],
  ["異", ["田"]],
  ["積", ["田"]],

  // === 禾 (grain) radical kanji ===
  ["和", ["禾"]],
  ["科", ["禾"]],
  ["秋", ["禾"]],
  ["秘", ["禾"]],
  ["租", ["禾"]],
  ["秩", ["禾"]],
  ["称", ["禾"]],
  ["移", ["禾"]],
  ["程", ["禾"]],
  ["税", ["禾"]],
  ["稀", ["禾"]],
  ["稚", ["禾"]],
  ["稲", ["禾"]],
  ["稼", ["禾"]],
  ["稿", ["禾"]],
  ["穂", ["禾"]],
  ["穀", ["禾"]],
  ["穣", ["禾"]],
  ["穏", ["禾"]],
  ["利", ["禾", "刀"]],
  ["秒", ["禾"]],
  ["種", ["禾"]],
  ["秀", ["禾"]],

  // === 艹 (grass) radical kanji ===
  ["芋", ["艹"]],
  ["花", ["艹"]],
  ["芸", ["艹"]],
  ["芽", ["艹"]],
  ["苗", ["艹"]],
  ["若", ["艹"]],
  ["苦", ["艹"]],
  ["茂", ["艹"]],
  ["茎", ["艹"]],
  ["茶", ["艹"]],
  ["草", ["艹"]],
  ["荒", ["艹"]],
  ["荘", ["艹"]],
  ["荷", ["艹"]],
  ["華", ["艹"]],
  ["菓", ["艹"]],
  ["菜", ["艹"]],
  ["菊", ["艹"]],
  ["著", ["艹"]],
  ["落", ["艹"]],
  ["葉", ["艹"]],
  ["葬", ["艹"]],
  ["蓄", ["艹"]],
  ["蓋", ["艹"]],
  ["蔵", ["艹"]],
  ["薄", ["艹"]],
  ["薦", ["艹"]],
  ["薪", ["艹"]],
  ["薫", ["艹"]],
  ["薬", ["艹"]],
  ["藍", ["艹"]],
  ["藤", ["艹"]],
  ["藩", ["艹"]],
  ["蘭", ["艹"]],
  ["萩", ["艹"]],
  ["蓮", ["艹"]],
  ["蕉", ["艹"]],
  ["藻", ["艹"]],
  ["英", ["艹"]],

  // === 鳥 (bird) radical kanji ===
  ["鳴", ["鳥"]],
  ["鶏", ["鳥"]],
  ["鶴", ["鳥"]],
  ["鷹", ["鳥"]],
  ["鳩", ["鳥"]],
  ["鴨", ["鳥"]],
  ["鵜", ["鳥"]],
  ["鷲", ["鳥"]],
  ["雌", ["鳥"]],
  ["雄", ["鳥"]],
  ["雅", ["鳥"]],

  // === 魚 (fish) radical kanji ===
  ["鯨", ["魚"]],
  ["鯉", ["魚"]],
  ["鮎", ["魚"]],
  ["鮪", ["魚"]],
  ["鯛", ["魚"]],
  ["鮭", ["魚"]],
  ["鰻", ["魚"]],
  ["鯖", ["魚"]],
  ["鰹", ["魚"]],
  ["鮮", ["魚"]],

  // === 虫 (insect) radical kanji ===
  ["蚊", ["虫"]],
  ["蛇", ["虫"]],
  ["蛍", ["虫"]],
  ["融", ["虫"]],
  ["蜂", ["虫"]],
  ["蝶", ["虫"]],
  ["蟹", ["虫"]],
  ["蚕", ["虫"]],
  ["蛙", ["虫"]],
  ["蛾", ["虫"]],
  ["蝉", ["虫"]],
  ["蟻", ["虫"]],
  ["触", ["虫"]],

  // === 犬/犭 (dog) radical kanji ===
  ["狂", ["犬"]],
  ["狙", ["犬"]],
  ["狭", ["犬"]],
  ["狩", ["犬"]],
  ["独", ["犬"]],
  ["狼", ["犬"]],
  ["猛", ["犬"]],
  ["猟", ["犬"]],
  ["猫", ["犬"]],
  ["猿", ["犬"]],
  ["獄", ["犬"]],
  ["獣", ["犬"]],
  ["獲", ["犬"]],
  ["猶", ["犬"]],
  ["献", ["犬"]],
  ["猪", ["犬"]],
  ["狐", ["犬"]],
  ["狸", ["犬"]],
  ["犯", ["犬"]],
  ["状", ["犬"]],

  // === 宀 (roof) radical kanji ===
  ["宇", ["宀"]],
  ["守", ["宀"]],
  ["完", ["宀"]],
  ["宗", ["宀"]],
  ["官", ["宀"]],
  ["宙", ["宀"]],
  ["定", ["宀"]],
  ["宜", ["宀"]],
  ["宝", ["宀"]],
  ["実", ["宀"]],
  ["客", ["宀"]],
  ["宣", ["宀"]],
  ["室", ["宀"]],
  ["宮", ["宀"]],
  ["宴", ["宀"]],
  ["害", ["宀"]],
  ["容", ["宀"]],
  ["密", ["宀"]],
  ["寂", ["宀"]],
  ["富", ["宀"]],
  ["寒", ["宀"]],
  ["察", ["宀"]],
  ["寛", ["宀"]],
  ["寝", ["宀"]],
  ["寡", ["宀"]],
  ["寧", ["宀"]],
  ["審", ["宀"]],
  ["寮", ["宀"]],
  ["宅", ["宀"]],

  // === 广 (cliff) radical kanji ===
  ["広", ["广"]],
  ["序", ["广"]],
  ["床", ["广"]],
  ["府", ["广"]],
  ["度", ["广"]],
  ["座", ["广"]],
  ["庭", ["广"]],
  ["康", ["广"]],
  ["庸", ["广"]],
  ["廃", ["广"]],
  ["廉", ["广"]],
  ["廊", ["广"]],
  ["庫", ["广"]],
  ["庁", ["广"]],
  ["厚", ["厂"]],

  // === 尸 (corpse) radical kanji ===
  ["尻", ["尸"]],
  ["尼", ["尸"]],
  ["尾", ["尸"]],
  ["居", ["尸"]],
  ["届", ["尸"]],
  ["屋", ["尸"]],
  ["展", ["尸"]],
  ["属", ["尸"]],
  ["層", ["尸"]],
  ["履", ["尸"]],
  ["屈", ["尸"]],
  ["尿", ["尸"]],

  // === 示/礻 (altar/show) radical kanji ===
  ["礼", ["示"]],
  ["祈", ["示"]],
  ["祉", ["示"]],
  ["祖", ["示"]],
  ["祝", ["示"]],
  ["神", ["示"]],
  ["祥", ["示"]],
  ["票", ["示"]],
  ["祭", ["示"]],
  ["禅", ["示"]],
  ["禍", ["示"]],
  ["福", ["示"]],
  ["禁", ["示"]],

  // === 衣/衤 (clothing) radical kanji ===
  ["初", ["衣"]],
  ["表", ["衣"]],
  ["衰", ["衣"]],
  ["袋", ["衣"]],
  ["被", ["衣"]],
  ["裁", ["衣"]],
  ["装", ["衣"]],
  ["裂", ["衣"]],
  ["裏", ["衣"]],
  ["裕", ["衣"]],
  ["補", ["衣"]],
  ["裸", ["衣"]],
  ["製", ["衣"]],
  ["複", ["衣"]],
  ["褐", ["衣"]],
  ["褒", ["衣"]],
  ["襲", ["衣"]],

  // === 頁 (page/head) radical kanji ===
  ["頂", ["頁"]],
  ["項", ["頁"]],
  ["順", ["頁"]],
  ["須", ["頁"]],
  ["預", ["頁"]],
  ["頑", ["頁"]],
  ["頒", ["頁"]],
  ["頓", ["頁"]],
  ["領", ["頁"]],
  ["頭", ["頁"]],
  ["頻", ["頁"]],
  ["頼", ["頁"]],
  ["題", ["頁"]],
  ["額", ["頁"]],
  ["願", ["頁"]],
  ["類", ["頁"]],
  ["顕", ["頁"]],
  ["顧", ["頁"]],
  ["顔", ["頁"]],

  // === 疒 (sickness) radical kanji ===
  ["疫", ["疒"]],
  ["疲", ["疒"]],
  ["病", ["疒"]],
  ["症", ["疒"]],
  ["痕", ["疒"]],
  ["痘", ["疒"]],
  ["痢", ["疒"]],
  ["痴", ["疒"]],
  ["療", ["疒"]],
  ["癒", ["疒"]],
  ["痩", ["疒"]],
  ["癌", ["疒"]],
  ["疾", ["疒"]],
  ["痛", ["疒"]],

  // === 力 (power) radical kanji ===
  ["功", ["力"]],
  ["加", ["力"]],
  ["助", ["力"]],
  ["効", ["力"]],
  ["勇", ["力"]],
  ["勉", ["力"]],
  ["動", ["力"]],
  ["勘", ["力"]],
  ["務", ["力"]],
  ["勝", ["力"]],
  ["勢", ["力"]],
  ["勤", ["力"]],
  ["勧", ["力"]],
  ["勲", ["力"]],
  ["募", ["力"]],
  ["劇", ["力"]],
  ["労", ["力"]],
  ["協", ["力"]],
  ["励", ["力"]],

  // === 刀/刂 (knife) radical kanji ===
  ["切", ["刀"]],
  ["刈", ["刀"]],
  ["刊", ["刀"]],
  ["刑", ["刀"]],
  ["列", ["刀"]],
  ["判", ["刀"]],
  ["別", ["刀"]],
  ["到", ["刀"]],
  ["制", ["刀"]],
  ["刷", ["刀"]],
  ["券", ["刀"]],
  ["刺", ["刀"]],
  ["刻", ["刀"]],
  ["剃", ["刀"]],
  ["則", ["刀"]],
  ["削", ["刀"]],
  ["剖", ["刀"]],
  ["剛", ["刀"]],
  ["剣", ["刀"]],
  ["副", ["刀"]],
  ["割", ["刀"]],
  ["創", ["刀"]],
  ["剰", ["刀"]],
  ["剥", ["刀"]],

  // === 巾 (cloth) radical kanji ===
  ["布", ["巾"]],
  ["帆", ["巾"]],
  ["希", ["巾"]],
  ["帝", ["巾"]],
  ["帯", ["巾"]],
  ["師", ["巾"]],
  ["席", ["巾"]],
  ["帳", ["巾"]],
  ["常", ["巾"]],
  ["帽", ["巾"]],
  ["幅", ["巾"]],
  ["幕", ["巾"]],
  ["幣", ["巾"]],

  // === 立 (stand) radical kanji ===
  ["竜", ["立"]],
  ["章", ["立"]],
  ["童", ["立"]],
  ["競", ["立"]],
  ["端", ["立"]],

  // === 皿 (dish) radical kanji ===
  ["盆", ["皿"]],
  ["益", ["皿"]],
  ["盟", ["皿"]],
  ["盗", ["皿"]],

  // === 羽 (feather) radical kanji ===
  ["翁", ["羽"]],
  ["翌", ["羽"]],
  ["習", ["羽"]],
  ["翔", ["羽"]],
  ["翠", ["羽"]],
  ["翻", ["羽"]],
  ["翼", ["羽"]],

  // === 舟 (boat) radical kanji ===
  ["航", ["舟"]],
  ["般", ["舟"]],
  ["船", ["舟"]],
  ["艇", ["舟"]],
  ["艦", ["舟"]],
  ["舵", ["舟"]],
  ["舶", ["舟"]],

  // === 酉 (wine) radical kanji ===
  ["酌", ["酉"]],
  ["配", ["酉"]],
  ["酒", ["酉"]],
  ["酔", ["酉"]],
  ["酢", ["酉"]],
  ["酪", ["酉"]],
  ["酬", ["酉"]],
  ["酵", ["酉"]],
  ["酷", ["酉"]],
  ["酸", ["酉"]],
  ["醜", ["酉"]],
  ["醒", ["酉"]],
  ["醤", ["酉"]],
  ["醸", ["酉"]],

  // === 革 (leather) radical kanji ===
  ["靴", ["革"]],
  ["鞄", ["革"]],
  ["鞍", ["革"]],
  ["韓", ["革"]],

  // === 音 (sound) radical kanji ===
  ["韻", ["音"]],
  ["響", ["音"]],

  // === OTHER IMPORTANT KANJI ===
  ["共", ["八"]],
  ["成", ["成"]],
  ["放", ["方"]],
  ["昔", ["日"]],
  ["育", ["肉"]],
  ["良", ["良"]],
  ["特", ["牛"]],
  ["旅", ["方"]],
  ["都", ["者"]],
  ["球", ["玉"]],
  ["陽", ["陽"]],
  ["階", ["階"]],
  ["期", ["月"]],
  ["登", ["登"]],
  ["整", ["整"]],
  ["料", ["米"]],
  ["殺", ["殺"]],
  ["映", ["日"]],
  ["皆", ["白"]],
  ["卒", ["卒"]],
  ["参", ["参"]],
  ["季", ["子"]],
  ["残", ["残"]],
  ["的", ["白"]],
  ["能", ["能"]],
  ["帰", ["帰"]],
  ["区", ["区"]],
  ["式", ["式"]],
  ["単", ["単"]],
  ["変", ["変"]],
  ["夫", ["大"]],
  ["建", ["廴"]],
  ["昨", ["日"]],
  ["毒", ["毒"]],
  ["晩", ["日"]],
  ["取", ["耳", "又"]],
  ["幸", ["幸"]],
  ["面", ["面"]],
  ["典", ["典"]],
  ["辞", ["辛"]],
  ["弁", ["弁"]],
  ["政", ["政"]],
  ["危", ["危"]],
  ["専", ["専"]],
  ["冗", ["冫"]],
  ["原", ["原"]],
  ["兵", ["八"]],
  ["暴", ["日"]],
  ["乱", ["乱"]],
  ["改", ["改"]],
  ["難", ["難"]],
  ["夢", ["夕"]],
  ["産", ["産"]],
  ["穴", ["穴"]],
  ["断", ["斤"]],
  ["義", ["義"]],
  ["脱", ["肉"]],
  ["置", ["网"]],
  ["営", ["営"]],
  ["規", ["見"]],
  ["施", ["方"]],
  ["現", ["玉", "見"]],
  ["乳", ["乳"]],
  ["差", ["差"]],
  ["象", ["象"]],
  ["量", ["量"]],
  ["武", ["武"]],
  ["与", ["与"]],
  ["影", ["影"]],
  ["豊", ["豆"]],
  ["肥", ["肉"]],
  ["巻", ["巻"]],
  ["替", ["日"]],
  ["往", ["行"]],
  ["故", ["攴"]],
  ["我", ["戈"]],
  ["郵", ["邑"]],
  ["突", ["穴"]],
  ["再", ["再"]],
  ["段", ["段"]],
  ["暇", ["日"]],
  ["岸", ["山"]],
  ["罪", ["网"]],
  ["収", ["又"]],
  ["歴", ["歴"]],
  ["舌", ["舌"]],
  ["失", ["大"]],
  ["夏", ["夂"]],
  ["南", ["十"]],
  ["両", ["一"]],
  ["医", ["匚"]],
  ["帆", ["巾"]],
  ["彩", ["彡"]],
  ["卓", ["十"]],
  ["超", ["走"]],
  ["戻", ["戸"]],
  ["北", ["匕"]],
  ["西", ["西"]],
  ["御", ["彳"]],
  ["雇", ["戸"]],
  ["群", ["羊"]],
  ["充", ["儿"]],
  ["孝", ["子"]],
  ["欧", ["欠"]],
  ["耕", ["耒"]],
  ["敬", ["攴"]],
  ["背", ["月"]],
  ["亡", ["一"]],
  ["契", ["大"]],
  ["兼", ["八"]],
  ["色", ["色"]],
  ["丸", ["九"]],
  ["井", ["二"]],
  ["全", ["入"]],
  ["声", ["士"]],
  ["互", ["二"]],
  ["也", ["也"]],
  ["既", ["白"]],
  ["形", ["彡"]],
  ["扉", ["戸"]],
  ["光", ["儿"]],
  ["腐", ["肉"]],
  ["凍", ["冫"]],
];

// Convert to Map for deduplication
const kanjiToRadicals = new Map<string, string[]>();
for (const [kanji, radicals] of kanjiRadicalMappings) {
  kanjiToRadicals.set(kanji, radicals);
}

async function main() {
  console.log("Starting kanji-radical relationship fix...\n");
  console.log("=".repeat(60));
  console.log("NIHONGO DATABASE RADICAL ANALYSIS");
  console.log("=".repeat(60));
  console.log("\n");

  // Step 1: Get all kanji from the database
  const allKanji = await prisma.kanji.findMany({
    select: {
      id: true,
      character: true,
      levelId: true,
    },
    orderBy: { levelId: "asc" },
  });
  console.log(`Total kanji in database: ${allKanji.length}\n`);

  // Step 2: Get all radicals from the database
  const allRadicals = await prisma.radical.findMany({
    select: {
      id: true,
      character: true,
      meaningFr: true,
      levelId: true,
    },
  });
  console.log(`Total radicals in database: ${allRadicals.length}\n`);

  // Analysis: WaniKani vs Kangxi vs our radicals
  console.log("=".repeat(60));
  console.log("RADICAL COUNT ANALYSIS");
  console.log("=".repeat(60));
  console.log(`Our radicals: ${allRadicals.length}`);
  console.log(`Kangxi radicals: 214`);
  console.log(`WaniKani radicals: ~478 (more granular for mnemonics)`);
  console.log(`Sufficiency: ${allRadicals.length >= 214 ? "YES - Covers Kangxi basics" : "NO - Need more radicals"}`);
  console.log("\n");

  // Create a map of radical character to radical IDs
  const radicalMap = new Map<string, number[]>();
  for (const radical of allRadicals) {
    if (radical.character) {
      const ids = radicalMap.get(radical.character) || [];
      ids.push(radical.id);
      radicalMap.set(radical.character, ids);
    }
  }
  console.log(`Unique radical characters mapped: ${radicalMap.size}\n`);

  // Log available radicals for reference
  console.log("Available radical characters in database:");
  const radChars = Array.from(radicalMap.keys());
  console.log(radChars.join(" "));
  console.log("\n");

  // Step 3: Check current kanji-radical relationships
  const existingRelations = await prisma.kanjiRadical.count();
  console.log(`Current kanji-radical relationships: ${existingRelations}\n`);

  // Count kanji without radicals
  const kanjiWithoutRadicals = await prisma.kanji.findMany({
    where: {
      radicals: {
        none: {},
      },
    },
    select: {
      id: true,
      character: true,
      levelId: true,
    },
    orderBy: { levelId: "asc" },
  });

  console.log("=".repeat(60));
  console.log("KANJI WITHOUT RADICALS");
  console.log("=".repeat(60));
  console.log(`Total kanji without radical assignments: ${kanjiWithoutRadicals.length}\n`);

  if (kanjiWithoutRadicals.length > 0) {
    // Group by level
    const byLevel: Record<number, string[]> = {};
    for (const kanji of kanjiWithoutRadicals) {
      if (!byLevel[kanji.levelId]) {
        byLevel[kanji.levelId] = [];
      }
      byLevel[kanji.levelId].push(kanji.character);
    }

    console.log("Kanji without radicals by level:");
    for (const [level, chars] of Object.entries(byLevel).sort(([a], [b]) => Number(a) - Number(b))) {
      console.log(`  Level ${level}: ${chars.join(", ")} (${chars.length} kanji)`);
    }
    console.log("\n");
  }

  // Step 4: Process each kanji and create relationships
  let created = 0;
  let skipped = 0;
  let selfLinked = 0;
  const missingDecompositions: string[] = [];
  const radicalsMissing: Set<string> = new Set();

  console.log("=".repeat(60));
  console.log("CREATING KANJI-RADICAL RELATIONSHIPS");
  console.log("=".repeat(60));

  for (const kanji of allKanji) {
    const kanjiChar = kanji.character;

    // Get decomposition for this kanji from our mapping
    let radicalChars = kanjiToRadicals.get(kanjiChar);

    // If no explicit decomposition, check if the kanji itself is a radical
    if (!radicalChars) {
      if (radicalMap.has(kanjiChar)) {
        radicalChars = [kanjiChar];
        selfLinked++;
      } else {
        missingDecompositions.push(kanjiChar);
        continue;
      }
    }

    // For each radical character in the decomposition
    for (const radChar of radicalChars) {
      const radicalIds = radicalMap.get(radChar);

      if (radicalIds && radicalIds.length > 0) {
        // Use the first radical ID (typically from lowest level)
        const radicalId = radicalIds[0];

        // Check if relationship already exists
        const existing = await prisma.kanjiRadical.findUnique({
          where: {
            kanjiId_radicalId: {
              kanjiId: kanji.id,
              radicalId: radicalId,
            },
          },
        });

        if (!existing) {
          await prisma.kanjiRadical.create({
            data: {
              kanjiId: kanji.id,
              radicalId: radicalId,
            },
          });
          created++;
        } else {
          skipped++;
        }
      } else {
        // Track radicals that are referenced but don't exist
        radicalsMissing.add(radChar);
      }
    }
  }

  // Step 5: Final report
  const finalRelations = await prisma.kanjiRadical.count();
  const finalKanjiWithoutRadicals = await prisma.kanji.count({
    where: {
      radicals: {
        none: {},
      },
    },
  });

  console.log("\n");
  console.log("=".repeat(60));
  console.log("SUMMARY REPORT");
  console.log("=".repeat(60));
  console.log(`New relationships created: ${created}`);
  console.log(`Relationships already existed (skipped): ${skipped}`);
  console.log(`Kanji self-linked (kanji = radical): ${selfLinked}`);
  console.log(`Kanji without decomposition data: ${missingDecompositions.length}`);
  console.log(`\nTotal relationships now: ${finalRelations}`);
  console.log(`Kanji still without radicals: ${finalKanjiWithoutRadicals}`);
  console.log("=".repeat(60));
  console.log("\n");

  if (radicalsMissing.size > 0) {
    console.log("Radicals referenced but not in database:");
    console.log(Array.from(radicalsMissing).join(" "));
    console.log("\nConsider adding these radicals to improve coverage.\n");
  }

  if (missingDecompositions.length > 0) {
    console.log(`\nKanji missing decomposition mapping (${missingDecompositions.length} total):`);
    console.log(missingDecompositions.join(" "));
    console.log("\nTo fix: Add these kanji to the kanjiRadicalMappings array above.\n");
  }

  // Analysis conclusion
  console.log("=".repeat(60));
  console.log("RECOMMENDATIONS");
  console.log("=".repeat(60));

  if (finalKanjiWithoutRadicals === 0) {
    console.log("All kanji now have at least one radical assigned!");
  } else {
    console.log(`${finalKanjiWithoutRadicals} kanji still need radical assignments.`);
    console.log("Options:");
    console.log("1. Add missing kanji to kanjiRadicalMappings array");
    console.log("2. Create new radicals if needed components don't exist");
    console.log("3. Link kanji to similar existing radicals as fallback");
  }

  console.log("\nRadical coverage analysis:");
  console.log(`- ${allRadicals.length} radicals cover ${allKanji.length - finalKanjiWithoutRadicals} kanji`);
  console.log(`- Coverage rate: ${((allKanji.length - finalKanjiWithoutRadicals) / allKanji.length * 100).toFixed(1)}%`);
}

main()
  .catch((e) => {
    console.error("Error:", e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
